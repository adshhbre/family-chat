# render.yaml (Simplified)
# This file configures the deployment of both the client and server on Render.
# The services will be manually linked via environment variables after deployment.

services:
  # -----------------
  # Backend Server
  # -----------------
  - type: web
    name: family-chat-server
    runtime: node
    rootDir: ./server
    buildCommand: npm install
    startCommand: npm start
    plan: free
    envVars:
      - key: NODE_VERSION
        value: "20"
      - key: JWT_SECRET
        generateValue: true
      - key: DATABASE_PATH
        value: /var/data/chat.db
    disks:
      - name: chat-db-disk
        mountPath: /var/data
        sizeGB: 1

  # -----------------
  # Frontend Client
  # -----------------
  - type: static site # Using the space as a last attempt, but the manual link is the real fix.
    name: family-chat-client
    rootDir: ./client
    buildCommand: npm install && npm run build
    publishDir: dist
    plan: free